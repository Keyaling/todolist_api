import{a as O,r as g,h as b,S as o,g as c,i as x,c as a,b as e,t as u,j as k,k as z,v as Q,n as C,F as I,l as S,o as l}from"./index-i4dGkM8o.js";const E={id:"todoListPage",class:"bg-half"},K=e("h1",null,[e("a",{href:"#"},"ONLINE TODO LIST")],-1),F={class:"todo_sm"},V={href:"#"},P={class:"container todoListPage vhContainer"},R={class:"todoList_Content"},U={class:"inputBox"},W=e("i",{class:"fa fa-plus"},null,-1),D=[W],G={key:0,class:"blank_content"},j=e("h2",null,"目前尚無待辦事項",-1),q=e("img",{src:"https://s3-alpha-sig.figma.com/img/7465/9ab1/8911ab6dcbda98df56e26aa23c6643ac?Expires=1725840000&Key-Pair-Id=APKAQ4GOSFWCVNEHN3O4&Signature=BmQcA76gk9l2y3s7vsRdmBkTjO8lYemchgz2fvvQqd6vEzKKoIKpTWxR5Iz6gkNQvICzQzSjfpXqRAiCmhCNaAQ6Nh7~7r0wEuxTCVOUzW8CGb7FlmUhs6GheqqJYxcxGV-lXtINwxY64LwHtFEXuKVwtdn2SiYuHNupWiTlTN77sAjR8vDZyjkSsuq4CXGVik3UGeHkJnsNAa-6eQ~QB-7HcW4F914N17QBifY47i8f~-AxsoBQ4OAmEM7uO-Jv1g1Wu7FEvy8-otCk79O2XZv6BpUsFTUyvDTR113J0ksi79QkwpeD8I6W4wZ1NxKwmvrxER6-COl7hStdVP1-QQ__",alt:""},null,-1),H=[j,q],X={key:1,class:"todoList_list"},Y={class:"todoList_tab"},J={class:"todoList_items"},M={class:"todoList_item"},Z={class:"todoList_label"},ee=["onClick","checked"],te=["onClick"],se=e("i",{class:"fa fa-times"},null,-1),oe=[se],ie={key:0,class:"todoList_statistics"},ne={key:1,class:"todoList_statistics"},ae={key:2,class:"todoList_statistics"},d="https://todolist-api.hexschool.io",ce={__name:"TodoList",setup(le){const T=O(),y=g({nickname:"",uid:""}),r=document.cookie.replace(/(?:(?:^|.*;\s*)customTodoToken\s*\=\s*([^;]*).*$)|^.*$/,"$1");b(async()=>{if(!r){o.fire({icon:"error",title:"您尚無資格登入",text:"Something went wrong!"}),T.push("/login");return}try{const t=await c.get(`${d}/users/checkout`,{headers:{Authorization:r}});y.value=t.data,_()}catch(t){console.log(t),o.fire({icon:"error",title:"驗證失效",text:"Something went wrong!"}),setTimeout(()=>{T.push("/login")},3e3)}});const h=g([]),_=async()=>{try{const t=await c.get(`${d}/todos`,{headers:{Authorization:r}});h.value=t.data.data}catch(t){o.fire(t.response.data.message)}},v=g(""),L=async()=>{if(v.value===""){o.fire("清單內容不能為空的");return}const t={content:v.value};try{const s=await c.post(`${d}/todos/`,t,{headers:{Authorization:r}});o.mixin({toast:!0,position:"top",showConfirmButton:!1,timer:500,timerProgressBar:!0,didOpen:w=>{w.onmouseenter=o.stopTimer,w.onmouseleave=o.resumeTimer}}).fire({icon:"success",title:"已新增代辦清單"})}catch(s){o.fire(s.response.data.message)}v.value="",_(),m("all")},$=async t=>{try{await c.patch(`${d}/todos/${t}/toggle`,{},{headers:{Authorization:r}})}catch(s){o.fire(s.response.data.message)}_()},A=async t=>{try{await c.delete(`${d}/todos/${t}`,{headers:{Authorization:r}}),o.mixin({toast:!0,position:"top",showConfirmButton:!1,timer:500,timerProgressBar:!0,didOpen:i=>{i.onmouseenter=o.stopTimer,i.onmouseleave=o.resumeTimer}}).fire({icon:"success",title:"已刪除代辦清單"})}catch(s){o.fire(s.response.data.message)}_()},n=g("all"),m=t=>{n.value=t},p=x(()=>n.value==="unfinished"?h.value.filter(t=>t.status===!1):n.value==="done"?h.value.filter(t=>t.status===!0):h.value),f=x(()=>p.value.filter(t=>t.status===!1).length),B=async()=>{try{const t=await c.post(`${d}/users/sign_out`,{},{headers:{Authorization:r}});console.log(t),o.fire(t.data.message)}catch(t){o.fire("登出失敗",`${t}`)}document.cookie="customTodoToken=",y.value="",setTimeout(()=>{T.push("/login")},1500)};return(t,s)=>(l(),a("div",E,[e("nav",null,[K,e("ul",null,[e("li",F,[e("a",V,[e("span",null,u(y.value.nickname)+"的代辦",1)])]),e("li",null,[e("a",{href:"#",onClick:k(B,["prevent"])},"登出")])])]),e("div",P,[e("div",R,[e("div",U,[z(e("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":s[0]||(s[0]=i=>v.value=i)},null,512),[[Q,v.value]]),e("button",{href:"#",onClick:L},D)]),h.value.length===0?(l(),a("div",G,H)):(l(),a("div",X,[e("ul",Y,[e("li",null,[e("a",{href:"#",class:C({active:n.value==="all"}),onClick:s[1]||(s[1]=k(i=>m("all"),["prevent"]))},"全部",2)]),e("li",null,[e("a",{href:"#",class:C({active:n.value==="unfinished"}),onClick:s[2]||(s[2]=k(i=>m("unfinished"),["prevent"]))},"待完成",2)]),e("li",null,[e("a",{href:"#",class:C({active:n.value==="done"}),onClick:s[3]||(s[3]=k(i=>m("done"),["prevent"]))},"已完成",2)])]),e("div",J,[e("ul",M,[(l(!0),a(I,null,S(p.value,(i,w)=>(l(),a("li",{key:i.id},[e("label",Z,[e("input",{class:"todoList_input",type:"checkbox",value:"true",onClick:N=>$(i.id),checked:i.status},null,8,ee),e("span",null,u(i.content),1)]),e("button",{onClick:N=>A(i.id)},oe,8,te)]))),128))]),n.value==="unfinished"?(l(),a("div",ie,[e("p",null," 總共有"+u(f.value)+" 個未完成項目",1)])):n.value==="done"?(l(),a("div",ne,[e("p",null," 總共有"+u(p.value.length-f.value)+" 個已完成項目",1)])):(l(),a("div",ae,[e("p",null," 總共有"+u(f.value)+" 個未完成項目",1),e("p",null," 總共有"+u(p.value.length-f.value)+" 個已完成項目",1)]))])]))])])]))}};export{ce as default};
